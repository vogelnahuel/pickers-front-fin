{"ast":null,"code":"var _jsxFileName = \"/home/nahuel/pickers-admin-front/src/pages/pickers/detailPicker/DetailPickerContainer.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useMemo, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport i18next from \"i18next\";\nimport moment from \"moment\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport * as yup from \"yup\";\nimport { actions as pendingUserAdminPickerActions, detailPickerSelector, hasPickerWrongFilesSelector, hasPickerAllFilesLoadedSelector } from \"reducers/detailPicker\";\nimport { pickersSelector, actions as pendingUserActions } from \"reducers/pickers\";\nimport { actions as notificationActions } from \"reducers/notification\";\nimport { DetailPicker } from \"pages/pickers/detailPicker/DetailPicker\";\nimport { DATE_FORMATS, VALIDATION_REGEX } from \"utils/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst DetailPickerContainer = props => {\n  _s();\n\n  const prevValues = useRef(null);\n  const params = useParams();\n  const history = useHistory();\n  useEffect(() => {\n    props.resetWrongFiles();\n    props.getPendingUserPicker(params.id);\n    props.getProvinces(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  let active = props.pendingUserAdminPicker.status && (props.pendingUserAdminPicker.status.id === 4 || props.pendingUserAdminPicker.status.id === 5);\n\n  const formatDate = function () {\n    let date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n    return moment(date, DATE_FORMATS.shortISODate, true).isValid() && date.length === 10 ? moment(date).format(DATE_FORMATS.shortDate) : date;\n  };\n\n  const initialValues = useMemo(() => {\n    var _props$pendingUserAdm, _props$pendingUserAdm2, _props$pendingUserAdm3, _props$pendingUserAdm4, _props$pendingUserAdm5, _props$pendingUserAdm6, _props$pendingUserAdm7, _props$pendingUserAdm8, _props$pendingUserAdm9, _props$pendingUserAdm10, _props$pendingUserAdm11, _props$pendingUserAdm12, _props$pendingUserAdm13, _props$pendingUserAdm14, _props$pendingUserAdm15, _props$pendingUserAdm16, _props$pendingUserAdm17, _props$pendingUserAdm18, _props$pendingUserAdm19, _props$pendingUserAdm20, _props$pendingUserAdm21, _props$pendingUserAdm22, _props$pendingUserAdm23, _props$pendingUserAdm24, _props$pendingUserAdm25, _props$pendingUserAdm26, _props$pendingUserAdm27, _props$pendingUserAdm28, _props$pendingUserAdm29, _props$pendingUserAdm30, _props$pendingUserAdm31, _props$pendingUserAdm32;\n\n    if (props.bankNameRequested) return prevValues.current || props.pendingUserAdminPicker;\n    prevValues.current = props.pendingUserAdminPicker.id ? { ...props.pendingUserAdminPicker,\n      personalData: { ...((_props$pendingUserAdm = props.pendingUserAdminPicker) === null || _props$pendingUserAdm === void 0 ? void 0 : _props$pendingUserAdm.personalData),\n        dateOfBirth: (_props$pendingUserAdm2 = props.pendingUserAdminPicker) !== null && _props$pendingUserAdm2 !== void 0 && (_props$pendingUserAdm3 = _props$pendingUserAdm2.personalData) !== null && _props$pendingUserAdm3 !== void 0 && _props$pendingUserAdm3.dateOfBirth && (_props$pendingUserAdm4 = props.pendingUserAdminPicker) !== null && _props$pendingUserAdm4 !== void 0 && (_props$pendingUserAdm5 = _props$pendingUserAdm4.personalData) !== null && _props$pendingUserAdm5 !== void 0 && _props$pendingUserAdm5.dateOfBirth.includes(\"-\") ? moment((_props$pendingUserAdm6 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm6 === void 0 ? void 0 : (_props$pendingUserAdm7 = _props$pendingUserAdm6.personalData) === null || _props$pendingUserAdm7 === void 0 ? void 0 : _props$pendingUserAdm7.dateOfBirth, DATE_FORMATS.shortISODate).format(DATE_FORMATS.shortDate) : (_props$pendingUserAdm8 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm8 === void 0 ? void 0 : (_props$pendingUserAdm9 = _props$pendingUserAdm8.personalData) === null || _props$pendingUserAdm9 === void 0 ? void 0 : _props$pendingUserAdm9.dateOfBirth\n      },\n      accountingData: { ...((_props$pendingUserAdm10 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm10 === void 0 ? void 0 : _props$pendingUserAdm10.accountingData),\n        sapInterlocutor: ((_props$pendingUserAdm11 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm11 === void 0 ? void 0 : (_props$pendingUserAdm12 = _props$pendingUserAdm11.accountingData) === null || _props$pendingUserAdm12 === void 0 ? void 0 : _props$pendingUserAdm12.sapInterlocutor) || \"-\",\n        fiscalNumber: (_props$pendingUserAdm13 = props.pendingUserAdminPicker) !== null && _props$pendingUserAdm13 !== void 0 && (_props$pendingUserAdm14 = _props$pendingUserAdm13.accountingData) !== null && _props$pendingUserAdm14 !== void 0 && (_props$pendingUserAdm15 = _props$pendingUserAdm14.fiscalNumber) !== null && _props$pendingUserAdm15 !== void 0 && _props$pendingUserAdm15.includes(\"-\") ? (_props$pendingUserAdm16 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm16 === void 0 ? void 0 : (_props$pendingUserAdm17 = _props$pendingUserAdm16.accountingData) === null || _props$pendingUserAdm17 === void 0 ? void 0 : _props$pendingUserAdm17.fiscalNumber : ((_props$pendingUserAdm18 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm18 === void 0 ? void 0 : (_props$pendingUserAdm19 = _props$pendingUserAdm18.accountingData) === null || _props$pendingUserAdm19 === void 0 ? void 0 : (_props$pendingUserAdm20 = _props$pendingUserAdm19.fiscalNumber) === null || _props$pendingUserAdm20 === void 0 ? void 0 : _props$pendingUserAdm20.slice(0, 2)) + \" - \" + ((_props$pendingUserAdm21 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm21 === void 0 ? void 0 : (_props$pendingUserAdm22 = _props$pendingUserAdm21.accountingData) === null || _props$pendingUserAdm22 === void 0 ? void 0 : (_props$pendingUserAdm23 = _props$pendingUserAdm22.fiscalNumber) === null || _props$pendingUserAdm23 === void 0 ? void 0 : _props$pendingUserAdm23.slice(2, 10)) + \" - \" + ((_props$pendingUserAdm24 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm24 === void 0 ? void 0 : (_props$pendingUserAdm25 = _props$pendingUserAdm24.accountingData) === null || _props$pendingUserAdm25 === void 0 ? void 0 : (_props$pendingUserAdm26 = _props$pendingUserAdm25.fiscalNumber) === null || _props$pendingUserAdm26 === void 0 ? void 0 : _props$pendingUserAdm26.slice(10, 11))\n      },\n      vehicle: { ...props.pendingUserAdminPicker.vehicle,\n        expirationDatePolicyVehicle: formatDate(((_props$pendingUserAdm27 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm27 === void 0 ? void 0 : (_props$pendingUserAdm28 = _props$pendingUserAdm27.vehicle) === null || _props$pendingUserAdm28 === void 0 ? void 0 : _props$pendingUserAdm28.expirationDatePolicyVehicle) || \"\"),\n        expirationDateIdentificationVehicle: formatDate(((_props$pendingUserAdm29 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm29 === void 0 ? void 0 : (_props$pendingUserAdm30 = _props$pendingUserAdm29.vehicle) === null || _props$pendingUserAdm30 === void 0 ? void 0 : _props$pendingUserAdm30.expirationDateIdentificationVehicle) || \"\"),\n        expirationDateDriverLicense: formatDate(((_props$pendingUserAdm31 = props.pendingUserAdminPicker) === null || _props$pendingUserAdm31 === void 0 ? void 0 : (_props$pendingUserAdm32 = _props$pendingUserAdm31.vehicle) === null || _props$pendingUserAdm32 === void 0 ? void 0 : _props$pendingUserAdm32.expirationDateDriverLicense) || \"\")\n      }\n    } : props.pendingUserAdminPicker;\n    return prevValues.current; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.pendingUserAdminPicker.id, props.bankNameRequested]);\n\n  const changePage = (page, isDirty) => {\n    let onClose = () => {\n      props.setActualPage(page);\n      if (history.location.pathname !== \"/pickers\" && history.length > 1) history.goBack();else if (history.length <= 1) {\n        history.replace(\"/pickers\");\n      }\n    };\n\n    if (isDirty) showDirtyNotification(onClose);else if (props.wrongFiles) showWrongFilesNotification(onClose);else onClose();\n  };\n\n  const cancel = (isDirty, form) => {\n    const restart = () => {\n      form.setConfig('keepDirtyOnReinitialize', false);\n      form.reset();\n      const {\n        values\n      } = form.getState();\n      const {\n        accountingData\n      } = values;\n\n      if ((accountingData === null || accountingData === void 0 ? void 0 : accountingData.bankIdentifier.length) === 22) {\n        var _accountingData$bankI;\n\n        const prefix = accountingData === null || accountingData === void 0 ? void 0 : (_accountingData$bankI = accountingData.bankIdentifier) === null || _accountingData$bankI === void 0 ? void 0 : _accountingData$bankI.substring(0, 3);\n        props.getBankName(prefix);\n      }\n\n      form.setConfig('keepDirtyOnReinitialize', true);\n    };\n\n    if (isDirty) showDirtyNotification(restart);else restart();\n  };\n\n  const goBack = (validate, isDirty) => {\n    if (validate) {\n      if (isDirty) showDirtyNotification(history.goBack);else if (props.wrongFiles) showWrongFilesNotification(history.goBack);else history.goBack();\n    } else history.goBack();\n  };\n\n  const showDirtyNotification = onClose => {\n    const html = document.documentElement;\n    const height = Math.max(html.clientHeight, html.scrollHeight);\n    return props.showNotification({\n      level: \"warning\",\n      title: i18next.t(\"pickers:title.modal.saveChanges\"),\n      body: i18next.t(\"pickers:label.modal.saveChanges\"),\n      onClickLabel: \"pickers:button.modal.goToSave\",\n      onCloseLabel: \"pickers:button.modal.notSave\",\n      onClose: onClose,\n      onClick: () => window.scroll({\n        top: height,\n        left: 0,\n        behavior: \"smooth\"\n      })\n    });\n  };\n\n  const showWrongFilesNotification = onClose => props.showNotification({\n    level: \"warning\",\n    title: i18next.t(\"global:title.modal.withoutSaving\"),\n    body: i18next.t(\"global:label.modal.withoutSaving\"),\n    onClickLabel: i18next.t(\"global:label.button.checkErrors\"),\n    onCloseLabel: i18next.t(\"global:label.button.continue\"),\n    onClose: onClose,\n    onClick: undefined\n  });\n\n  const aproveSubmit = (params, goBack) => {\n    props.showNotification({\n      level: \"info\",\n      title: i18next.t(\"detailPicker:title.modal.approvePicker\"),\n      body: i18next.t(\"detailPicker:label.modal.approvePicker\"),\n      onClickLabel: \"detailPicker:label.button.approve\",\n      onCloseLabel: \"detailPicker:label.button.revise\",\n      onClick: () => props.postAprovePickerRequest(params, goBack),\n      onClose: undefined\n    });\n  };\n\n  const validationSchema = yup.object({\n    personalData: yup.object({\n      name: yup.string().required(i18next.t(\"global:error.input.required\")).matches(VALIDATION_REGEX.expName, i18next.t(\"global:error.input.numbersOrSpecialCharacters\")),\n      surname: yup.string().required(i18next.t(\"global:error.input.required\")).matches(VALIDATION_REGEX.expName, i18next.t(\"global:error.input.numbersOrSpecialCharacters\")),\n      phone: yup.object({\n        areaNumber: yup.string().required(i18next.t(\"global:error.input.required\")).matches(VALIDATION_REGEX.regArea, i18next.t(\"global:error.input.invalidFormat\")),\n        number: yup.string().required(i18next.t(\"global:error.input.required\")).matches(VALIDATION_REGEX.regTelefono, i18next.t(\"global:error.input.invalidFormat\"))\n      })\n    }),\n    accountingData: yup.object({\n      bankIdentifier: yup.string().test(\"invalidBankIdentifier\", i18next.t(\"detailPicker:error.input.invalidBank\"), () => !props.invalidBank).required(i18next.t(\"global:error.input.required\")).min(22, i18next.t(\"detailPicker:error.input.invalidBank\")).matches(VALIDATION_REGEX.regNumber, i18next.t(\"global:error.input.lettersOrSpecialCharacters\")),\n      address: yup.object({\n        street: yup.string().required(i18next.t(\"global:error.input.required\")).matches(VALIDATION_REGEX.regStreet, i18next.t(\"global:error.input.formatAddress\")),\n        streetNumber: yup.string().matches(VALIDATION_REGEX.regStreet, i18next.t(\"global:error.input.formatAddress\")).required(i18next.t(\"global:error.input.required\")),\n        postalCode: yup.string().min(4, i18next.t(\"global:error.input.cp\")).matches(VALIDATION_REGEX.regNumber, i18next.t(\"global:error.input.lettersOrSpecialCharacters\")).required(i18next.t(\"global:error.input.required\")),\n        locality: yup.string().matches(VALIDATION_REGEX.regStreet, i18next.t(\"global:error.input.formatAddress\")).required(i18next.t(\"global:error.input.required\")),\n        province: yup.object().required(i18next.t(\"global:error.input.required\"))\n      })\n    }),\n    vehicle: props.pendingUserAdminPicker.vehicle && props.pendingUserAdminPicker.vehicle.type === \"motorcycle\" ? yup.object({\n      patent: yup.string().nullable().required(i18next.t(\"global:error.input.required\")).min(6, i18next.t(\"global:error.input.patentLong\")).matches(VALIDATION_REGEX.regPatent, i18next.t(\"global:error.input.patentFormat\")),\n      expirationDatePolicyVehicle: yup.string().nullable().required(i18next.t(\"global:error.input.required\")).matches(DATE_FORMATS.regex, i18next.t(\"global:error.input.invalidFormat\")).matches(DATE_FORMATS.regexValidCharacter, i18next.t(\"global:error.input.invalidFormat\")),\n      expirationDateIdentificationVehicle: yup.string().nullable().required(i18next.t(\"global:error.input.required\")).matches(DATE_FORMATS.regex, i18next.t(\"global:error.input.invalidFormat\")).matches(DATE_FORMATS.regexValidCharacter, i18next.t(\"global:error.input.invalidFormat\")),\n      expirationDateDriverLicense: yup.string().nullable().required(i18next.t(\"global:error.input.required\")).matches(DATE_FORMATS.regex, i18next.t(\"global:error.input.invalidFormat\")).matches(DATE_FORMATS.regexValidCharacter, i18next.t(\"global:error.input.invalidFormat\"))\n    }) : yup.object({})\n  });\n  return /*#__PURE__*/_jsxDEV(DetailPicker, { ...props,\n    initialValues: initialValues,\n    validationSchema: validationSchema,\n    changePage: changePage,\n    cancel: cancel,\n    goBack: goBack,\n    aproveSubmit: aproveSubmit,\n    active: active,\n    formatDate: formatDate,\n    getBankName: props.getBankName\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 348,\n    columnNumber: 5\n  }, this);\n};\n\n_s(DetailPickerContainer, \"H4WYDFztnswm/mzkKxPL6LUojOo=\", false, function () {\n  return [useParams, useHistory];\n});\n\n_c = DetailPickerContainer;\n\nconst mapStateToProps = state => ({\n  pendingUserAdminPicker: detailPickerSelector(state).pendingUserAdminPicker,\n  isFetching: detailPickerSelector(state).fetching,\n  invalidBank: detailPickerSelector(state).invalidBank,\n  bankNameRequested: detailPickerSelector(state).bankNameRequested,\n  actualPage: pickersSelector(state).actualPage,\n  nameDisplay: detailPickerSelector(state).nameDisplay,\n  wrongFiles: hasPickerWrongFilesSelector(state),\n  loadedFiles: hasPickerAllFilesLoadedSelector(state),\n  provinces: detailPickerSelector(state).provinces\n});\n\nconst mapDispatchToProps = dispatch => ({\n  getBankName: cbuPrefix => {\n    dispatch(pendingUserAdminPickerActions.getBankNameFetch({\n      cbuPrefix\n    }));\n  },\n  getPendingUserPicker: params => {\n    dispatch(pendingUserAdminPickerActions.getPendingUserPickerRequest(params));\n  },\n  getProvinces: () => {\n    dispatch(pendingUserAdminPickerActions.getProvincesRequest());\n  },\n  getPendingUserPickerExport: params => {\n    dispatch(pendingUserAdminPickerActions.getPendingUserPickerExportRequest(params));\n  },\n  setDirty: dirty => {\n    dispatch(pendingUserAdminPickerActions.setDirty(dirty));\n  },\n  postAprovePickerRequest: (params, goBack) => {\n    dispatch(pendingUserAdminPickerActions.getAprovePickerRequest({\n      params,\n      goBack\n    }));\n  },\n  postPendingUserDocumentsEdit: params => {\n    dispatch(pendingUserAdminPickerActions.getPendingUserPickerDocumentsEditRequest(params));\n  },\n  showNotification: content => {\n    dispatch(notificationActions.showNotification(content));\n  },\n  postEditPickerRequest: (params, goBack) => {\n    dispatch(pendingUserAdminPickerActions.getEditPickerRequest({\n      params,\n      goBack\n    }));\n  },\n  setActualPage: page => {\n    dispatch(pendingUserActions.setActualPage(page));\n  },\n  resetWrongFiles: () => {\n    dispatch(pendingUserAdminPickerActions.resetWrongFiles());\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailPickerContainer);\n\nvar _c;\n\n$RefreshReg$(_c, \"DetailPickerContainer\");","map":{"version":3,"sources":["/home/nahuel/pickers-admin-front/src/pages/pickers/detailPicker/DetailPickerContainer.tsx"],"names":["React","useEffect","useMemo","useRef","connect","i18next","moment","useHistory","useParams","yup","actions","pendingUserAdminPickerActions","detailPickerSelector","hasPickerWrongFilesSelector","hasPickerAllFilesLoadedSelector","pickersSelector","pendingUserActions","notificationActions","DetailPicker","DATE_FORMATS","VALIDATION_REGEX","DetailPickerContainer","props","prevValues","params","history","resetWrongFiles","getPendingUserPicker","id","getProvinces","active","pendingUserAdminPicker","status","formatDate","date","shortISODate","isValid","length","format","shortDate","initialValues","bankNameRequested","current","personalData","dateOfBirth","includes","accountingData","sapInterlocutor","fiscalNumber","slice","vehicle","expirationDatePolicyVehicle","expirationDateIdentificationVehicle","expirationDateDriverLicense","changePage","page","isDirty","onClose","setActualPage","location","pathname","goBack","replace","showDirtyNotification","wrongFiles","showWrongFilesNotification","cancel","form","restart","setConfig","reset","values","getState","bankIdentifier","prefix","substring","getBankName","validate","html","document","documentElement","height","Math","max","clientHeight","scrollHeight","showNotification","level","title","t","body","onClickLabel","onCloseLabel","onClick","window","scroll","top","left","behavior","undefined","aproveSubmit","postAprovePickerRequest","validationSchema","object","name","string","required","matches","expName","surname","phone","areaNumber","regArea","number","regTelefono","test","invalidBank","min","regNumber","address","street","regStreet","streetNumber","postalCode","locality","province","type","patent","nullable","regPatent","regex","regexValidCharacter","mapStateToProps","state","isFetching","fetching","actualPage","nameDisplay","loadedFiles","provinces","mapDispatchToProps","dispatch","cbuPrefix","getBankNameFetch","getPendingUserPickerRequest","getProvincesRequest","getPendingUserPickerExport","getPendingUserPickerExportRequest","setDirty","dirty","getAprovePickerRequest","postPendingUserDocumentsEdit","getPendingUserPickerDocumentsEditRequest","content","postEditPickerRequest","getEditPickerRequest"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport i18next from \"i18next\";\nimport moment from \"moment\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport * as yup from \"yup\";\n\nimport { AppDispatch, RootState } from \"store\";\n\nimport {\n  actions as pendingUserAdminPickerActions,\n  detailPickerSelector,\n  hasPickerWrongFilesSelector,\n  hasPickerAllFilesLoadedSelector,\n} from \"reducers/detailPicker\";\nimport {\n  pickersSelector,\n  actions as pendingUserActions,\n} from \"reducers/pickers\";\nimport { actions as notificationActions } from \"reducers/notification\";\n\nimport {\n  PickerType,\n  ParamsMiddlewareType,\n  DetailPickerValidationSchema,\n} from \"../types\";\n\nimport { DetailPickerContainerTypeProps, pickerTabs } from \"./types\";\n\nimport { DetailPicker } from \"pages/pickers/detailPicker/DetailPicker\";\nimport { DATE_FORMATS, VALIDATION_REGEX } from \"utils/constants\";\nimport { NotificationStateType } from \"reducers/types/notification\";\nimport { FormApi } from \"final-form\";\n\nconst DetailPickerContainer: React.FC<DetailPickerContainerTypeProps> = (\n  props\n): JSX.Element => {\n  const prevValues = useRef<PickerType | null>(null);\n  const params: { id?: string } = useParams();\n  const history = useHistory();\n\n  useEffect(() => {\n    props.resetWrongFiles();\n    props.getPendingUserPicker(params.id);\n    props.getProvinces();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  let active: boolean =\n    props.pendingUserAdminPicker.status &&\n    (props.pendingUserAdminPicker.status.id === 4 ||\n      props.pendingUserAdminPicker.status.id === 5);\n\n  const formatDate = (date: string | undefined = \"\"): string => {\n    return moment(date, DATE_FORMATS.shortISODate, true).isValid() &&\n      date.length === 10\n      ? moment(date).format(DATE_FORMATS.shortDate)\n      : date;\n  };\n\n  const initialValues = useMemo(() => {\n    if (props.bankNameRequested)\n      return prevValues.current || props.pendingUserAdminPicker;\n\n    prevValues.current = props.pendingUserAdminPicker.id\n      ? {\n          ...props.pendingUserAdminPicker,\n          personalData: {\n            ...props.pendingUserAdminPicker?.personalData,\n            dateOfBirth:\n              props.pendingUserAdminPicker?.personalData?.dateOfBirth &&\n              props.pendingUserAdminPicker?.personalData?.dateOfBirth.includes(\n                \"-\"\n              )\n                ? moment(\n                    props.pendingUserAdminPicker?.personalData?.dateOfBirth,\n                    DATE_FORMATS.shortISODate\n                  ).format(DATE_FORMATS.shortDate)\n                : props.pendingUserAdminPicker?.personalData?.dateOfBirth,\n          },\n          accountingData: {\n            ...props.pendingUserAdminPicker?.accountingData,\n            sapInterlocutor:\n              props.pendingUserAdminPicker?.accountingData?.sapInterlocutor ||\n              \"-\",\n            fiscalNumber:\n              props.pendingUserAdminPicker?.accountingData?.fiscalNumber?.includes(\n                \"-\"\n              )\n                ? props.pendingUserAdminPicker?.accountingData?.fiscalNumber\n                : props.pendingUserAdminPicker?.accountingData?.fiscalNumber?.slice(\n                    0,\n                    2\n                  ) +\n                  \" - \" +\n                  props.pendingUserAdminPicker?.accountingData?.fiscalNumber?.slice(\n                    2,\n                    10\n                  ) +\n                  \" - \" +\n                  props.pendingUserAdminPicker?.accountingData?.fiscalNumber?.slice(\n                    10,\n                    11\n                  ),\n          },\n          vehicle: {\n            ...props.pendingUserAdminPicker.vehicle,\n\n            expirationDatePolicyVehicle: formatDate(\n              props.pendingUserAdminPicker?.vehicle\n                ?.expirationDatePolicyVehicle || \"\"\n            ),\n            expirationDateIdentificationVehicle: formatDate(\n              props.pendingUserAdminPicker?.vehicle\n                ?.expirationDateIdentificationVehicle || \"\"\n            ),\n            expirationDateDriverLicense: formatDate(\n              props.pendingUserAdminPicker?.vehicle\n                ?.expirationDateDriverLicense || \"\"\n            ),\n          },\n        }\n      : props.pendingUserAdminPicker;\n\n    return prevValues.current;\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.pendingUserAdminPicker.id, props.bankNameRequested]);\n\n  const changePage = (page: string, isDirty: boolean) => {\n    let onClose = () => {\n      props.setActualPage(page);\n\n      if (history.location.pathname !== \"/pickers\" && history.length > 1)\n        history.goBack();\n      else if (history.length <= 1) {\n        history.replace(\"/pickers\");\n      }\n    };\n    if (isDirty) showDirtyNotification(onClose);\n    else if (props.wrongFiles) showWrongFilesNotification(onClose);\n    else onClose();\n  };\n\n  const cancel = (isDirty: boolean, form: FormApi<object, object>) => {\n    const restart = () => {\n      form.setConfig('keepDirtyOnReinitialize', false);\n      form.reset();\n      const { values } = form.getState();\n      const { accountingData } = values as PickerType;\n      if(accountingData?.bankIdentifier.length === 22){\n        const prefix = accountingData?.bankIdentifier?.substring(0, 3);\n        props.getBankName(prefix);\n      }\n      form.setConfig('keepDirtyOnReinitialize', true);\n    }\n    if (isDirty) showDirtyNotification(restart);\n    else restart();\n  };\n\n  const goBack = (validate?: boolean, isDirty?: boolean) => {\n    if (validate) {\n      if (isDirty) showDirtyNotification(history.goBack);\n      else if (props.wrongFiles) showWrongFilesNotification(history.goBack);\n      else history.goBack();\n    } else history.goBack();\n  };\n\n  const showDirtyNotification = (onClose: Function) => {\n    const html = document.documentElement;\n    const height = Math.max(html.clientHeight, html.scrollHeight);\n\n    return props.showNotification({\n      level: \"warning\",\n      title: i18next.t(\"pickers:title.modal.saveChanges\"),\n      body: i18next.t(\"pickers:label.modal.saveChanges\"),\n      onClickLabel: \"pickers:button.modal.goToSave\",\n      onCloseLabel: \"pickers:button.modal.notSave\",\n      onClose: onClose,\n      onClick: () =>\n        window.scroll({\n          top: height,\n          left: 0,\n          behavior: \"smooth\",\n        }),\n    });\n  };\n\n  const showWrongFilesNotification = (onClose: Function) =>\n    props.showNotification({\n      level: \"warning\",\n      title: i18next.t(\"global:title.modal.withoutSaving\"),\n      body: i18next.t(\"global:label.modal.withoutSaving\"),\n      onClickLabel: i18next.t(\"global:label.button.checkErrors\"),\n      onCloseLabel: i18next.t(\"global:label.button.continue\"),\n      onClose: onClose,\n      onClick: undefined,\n    });\n\n  const aproveSubmit = (params: PickerType, goBack: Function) => {\n    props.showNotification({\n      level: \"info\",\n      title: i18next.t(\"detailPicker:title.modal.approvePicker\"),\n      body: i18next.t(\"detailPicker:label.modal.approvePicker\"),\n      onClickLabel: \"detailPicker:label.button.approve\",\n      onCloseLabel: \"detailPicker:label.button.revise\",\n      onClick: () => props.postAprovePickerRequest(params, goBack),\n      onClose: undefined,\n    });\n  };\n\n  const validationSchema: yup.SchemaOf<DetailPickerValidationSchema> =\n    yup.object({\n      personalData: yup.object({\n        name: yup\n          .string()\n          .required(i18next.t(\"global:error.input.required\"))\n          .matches(\n            VALIDATION_REGEX.expName,\n            i18next.t(\"global:error.input.numbersOrSpecialCharacters\")\n          ),\n        surname: yup\n          .string()\n          .required(i18next.t(\"global:error.input.required\"))\n          .matches(\n            VALIDATION_REGEX.expName,\n            i18next.t(\"global:error.input.numbersOrSpecialCharacters\")\n          ),\n        phone: yup.object({\n          areaNumber: yup\n            .string()\n            .required(i18next.t(\"global:error.input.required\"))\n            .matches(\n              VALIDATION_REGEX.regArea,\n              i18next.t(\"global:error.input.invalidFormat\")\n            ),\n          number: yup\n            .string()\n            .required(i18next.t(\"global:error.input.required\"))\n            .matches(\n              VALIDATION_REGEX.regTelefono,\n              i18next.t(\"global:error.input.invalidFormat\")\n            ),\n        }),\n      }),\n      accountingData: yup.object({\n        bankIdentifier: yup\n          .string()\n          .test(\n            \"invalidBankIdentifier\",\n            i18next.t(\"detailPicker:error.input.invalidBank\"),\n            () => !props.invalidBank\n          )\n          .required(i18next.t(\"global:error.input.required\"))\n          .min(22, i18next.t(\"detailPicker:error.input.invalidBank\"))\n          .matches(\n            VALIDATION_REGEX.regNumber,\n            i18next.t(\"global:error.input.lettersOrSpecialCharacters\")\n          ),\n        address: yup.object({\n          street: yup\n            .string()\n            .required(i18next.t(\"global:error.input.required\"))\n            .matches(\n              VALIDATION_REGEX.regStreet,\n              i18next.t(\"global:error.input.formatAddress\")\n            ),\n          streetNumber: yup\n            .string()\n            .matches(\n              VALIDATION_REGEX.regStreet,\n              i18next.t(\"global:error.input.formatAddress\")\n            )\n            .required(i18next.t(\"global:error.input.required\")),\n          postalCode: yup\n            .string()\n            .min(4, i18next.t(\"global:error.input.cp\"))\n            .matches(\n              VALIDATION_REGEX.regNumber,\n              i18next.t(\"global:error.input.lettersOrSpecialCharacters\")\n            )\n            .required(i18next.t(\"global:error.input.required\")),\n          locality: yup\n            .string()\n            .matches(\n              VALIDATION_REGEX.regStreet,\n              i18next.t(\"global:error.input.formatAddress\")\n            )\n            .required(i18next.t(\"global:error.input.required\")),\n          province: yup\n            .object()\n            .required(i18next.t(\"global:error.input.required\")),\n        }),\n      }),\n      vehicle:\n        props.pendingUserAdminPicker.vehicle &&\n        props.pendingUserAdminPicker.vehicle.type === \"motorcycle\"\n          ? yup.object({\n              patent: yup\n                .string()\n                .nullable()\n                .required(i18next.t(\"global:error.input.required\"))\n                .min(6, i18next.t(\"global:error.input.patentLong\"))\n                .matches(\n                  VALIDATION_REGEX.regPatent,\n                  i18next.t(\"global:error.input.patentFormat\")\n                ),\n              expirationDatePolicyVehicle: yup\n                .string()\n                .nullable()\n                .required(i18next.t(\"global:error.input.required\"))\n                .matches(\n                  DATE_FORMATS.regex,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                )\n                .matches(\n                  DATE_FORMATS.regexValidCharacter,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                ),\n              expirationDateIdentificationVehicle: yup\n                .string()\n                .nullable()\n                .required(i18next.t(\"global:error.input.required\"))\n                .matches(\n                  DATE_FORMATS.regex,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                )\n                .matches(\n                  DATE_FORMATS.regexValidCharacter,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                ),\n              expirationDateDriverLicense: yup\n                .string()\n                .nullable()\n                .required(i18next.t(\"global:error.input.required\"))\n                .matches(\n                  DATE_FORMATS.regex,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                )\n                .matches(\n                  DATE_FORMATS.regexValidCharacter,\n                  i18next.t(\"global:error.input.invalidFormat\")\n                ),\n            })\n          : yup.object({}),\n    });\n\n  return (\n    <DetailPicker\n      {...props}\n      initialValues={initialValues}\n      validationSchema={validationSchema}\n      changePage={changePage}\n      cancel={cancel}\n      goBack={goBack}\n      aproveSubmit={aproveSubmit}\n      active={active}\n      formatDate={formatDate}\n      getBankName={props.getBankName}\n    />\n  );\n};\n\nconst mapStateToProps = (state: RootState) => ({\n  pendingUserAdminPicker: detailPickerSelector(state).pendingUserAdminPicker,\n  isFetching: detailPickerSelector(state).fetching,\n  invalidBank: detailPickerSelector(state).invalidBank,\n  bankNameRequested: detailPickerSelector(state).bankNameRequested,\n  actualPage: pickersSelector(state).actualPage,\n  nameDisplay: detailPickerSelector(state).nameDisplay,\n  wrongFiles: hasPickerWrongFilesSelector(state),\n  loadedFiles: hasPickerAllFilesLoadedSelector(state),\n  provinces: detailPickerSelector(state).provinces,\n});\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => ({\n  getBankName: (cbuPrefix: string) => {\n    dispatch(pendingUserAdminPickerActions.getBankNameFetch({ cbuPrefix }));\n  },\n  getPendingUserPicker: (params: number) => {\n    dispatch(pendingUserAdminPickerActions.getPendingUserPickerRequest(params));\n  },\n  getProvinces: () => {\n    dispatch(pendingUserAdminPickerActions.getProvincesRequest());\n  },\n  getPendingUserPickerExport: (params: ParamsMiddlewareType) => {\n    dispatch(\n      pendingUserAdminPickerActions.getPendingUserPickerExportRequest(params)\n    );\n  },\n  setDirty: (dirty: boolean) => {\n    dispatch(pendingUserAdminPickerActions.setDirty(dirty));\n  },\n  postAprovePickerRequest: (params: PickerType, goBack: Function) => {\n    dispatch(\n      pendingUserAdminPickerActions.getAprovePickerRequest({ params, goBack })\n    );\n  },\n  postPendingUserDocumentsEdit: (params: PickerType) => {\n    dispatch(\n      pendingUserAdminPickerActions.getPendingUserPickerDocumentsEditRequest(\n        params\n      )\n    );\n  },\n  showNotification: (content: NotificationStateType) => {\n    dispatch(notificationActions.showNotification(content));\n  },\n  postEditPickerRequest: (params: PickerType, goBack: Function) => {\n    dispatch(\n      pendingUserAdminPickerActions.getEditPickerRequest({ params, goBack })\n    );\n  },\n  setActualPage: (page: pickerTabs) => {\n    dispatch(pendingUserActions.setActualPage(page));\n  },\n  resetWrongFiles: () => {\n    dispatch(pendingUserAdminPickerActions.resetWrongFiles());\n  },\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(DetailPickerContainer);\n"]},"metadata":{},"sourceType":"module"}