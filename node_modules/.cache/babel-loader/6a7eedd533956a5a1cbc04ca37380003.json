{"ast":null,"code":"import { createSlice, createSelector } from \"@reduxjs/toolkit\";\nimport { endsWithAny } from \"utils/endsWithAny\";\nexport const initialState = {\n  fetching: false,\n  invoiceFileStatus: {\n    error: false,\n    loading: false,\n    message: \"\"\n  },\n  preliquidations: [],\n  dirty: false,\n  preliquidationsSelected: [],\n  filters: {},\n  filtersExtra: {\n    limit: 3,\n    offset: 0\n  },\n  filtersExtraSeeMore: {\n    limit: 15,\n    offset: 0\n  },\n  seeMore: true,\n  invoiceTypes: [],\n  detailPreliquidations: {\n    id: 0,\n    status: {\n      id: 0,\n      description: \"\",\n      tag: \"\"\n    },\n    generatedAt: \"\",\n    fiscalNumber: \"\",\n    companyName: \"\",\n    sapCode: \"\",\n    total: 0.0,\n    manualCorrection: {\n      maxAllowedPlus: 0.0,\n      maxAllowedSubtract: 0.0\n    },\n    histories: [],\n    transactions: {\n      quantity: 0,\n      items: []\n    }\n  },\n  invoiceDetail: {\n    id: 0,\n    emisionDate: \"\",\n    invoiceNumber: \"\",\n    salePoint: \"\",\n    invoiceType: {\n      name: \"\",\n      tag: \"\"\n    },\n    caeNumber: \"\",\n    fiscalData: {\n      fiscalNumber: \"\",\n      companyName: \"\",\n      taxPayerType: \"\",\n      total: 0\n    },\n    invoiceFile: {\n      upload: false,\n      url: null\n    },\n    presettementId: undefined\n  },\n  actualPage: \"preliquidation\"\n};\nconst SLICE_NAME = \"preliquidation\";\n\nconst isRequestAction = action => {\n  const {\n    type\n  } = action;\n  return type.startsWith(SLICE_NAME) && type.endsWith(\"Request\");\n};\n\nconst isResponseAction = action => {\n  const {\n    type\n  } = action;\n  return type.startsWith(SLICE_NAME) && endsWithAny(type, [\"Error\", \"Success\"]);\n};\n\nexport const preliquidationSlice = createSlice({\n  name: SLICE_NAME,\n  initialState,\n  reducers: {\n    reset: state => {\n      state = { ...initialState\n      };\n    },\n    getPreliquidationsRequest: (state, action) => {},\n    getMorePreliquidationsRequest: (state, action) => {},\n    getPreliquidationsSuccess: (state, action) => {\n      const {\n        payload\n      } = action;\n      state.preliquidations = payload.result.items;\n      state.seeMore = payload.hasMore;\n      state.filtersExtraSeeMore.offset = payload.offset + payload.limit;\n    },\n    getMorePreliquidationsSuccess: (state, action) => {\n      const {\n        payload\n      } = action;\n      state.preliquidations = [...state.preliquidations, ...payload.items];\n      state.seeMore = payload.hasMore;\n      state.filtersExtraSeeMore.offset = payload.offset + payload.limit;\n    },\n    getPreliquidationsError: () => {},\n    getMorePreliquidationsError: () => {},\n    setPreliquidationFilters: (state, action) => {\n      state.filters = action.payload;\n    },\n    setPreliquidationExtraFilters: (state, action) => {\n      state.filtersExtra = { ...state.filtersExtra,\n        ...action.payload\n      };\n    },\n    getInvoiceDetailRequest: (state, action) => {},\n    getInvoiceDetailError: () => {},\n    getInvoiceDetailSuccess: (state, action) => {\n      const {\n        payload\n      } = action;\n      const {\n        presettlement,\n        ...invoice\n      } = payload;\n      state.invoiceDetail = invoice;\n      state.detailPreliquidations = { ...state.detailPreliquidations,\n        ...presettlement\n      };\n    },\n    getInvoiceDetailSaveRequest: (state, action) => {},\n    getInvoiceDetailSaveError: () => {},\n    getInvoiceDetailSaveSuccess: () => {},\n    getInvoiceDetailApproveRequest: (state, action) => {},\n    getInvoiceDetailApproveError: () => {},\n    getInvoiceDetailApproveSuccess: () => {},\n    getInvoiceDetailDeleteRequest: (state, action) => {},\n    getInvoiceDetailDeleteError: () => {},\n    getInvoiceDetailDeleteSuccess: () => {},\n    replaceInvoiceFile: (state, action) => {},\n    replaceInvoiceFileError: state => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\"\n      };\n    },\n    uploadInvoiceFile: (state, action) => {},\n    uploadInvoiceFileError: state => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\"\n      };\n    },\n    uploadInvoiceFileSuccess: (state, action) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: false,\n        message: \"\"\n      };\n      state.invoiceDetail.invoiceFile = {\n        upload: true,\n        url: action.payload\n      };\n    },\n    deleteInvoiceFileRequest: (state, action) => {},\n    deleteInvoiceFileError: state => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\"\n      };\n    },\n    deleteInvoiceFileSuccess: state => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: false,\n        message: \"\"\n      };\n      state.invoiceDetail.invoiceFile = {\n        upload: false,\n        url: null\n      };\n    },\n    getInvoiceDetailTypesRequest: () => {},\n    getInvoiceDetailTypesError: () => {},\n    getInvoiceDetailTypesSuccess: (state, action) => {\n      const {\n        payload\n      } = action;\n      state.invoiceTypes = payload;\n    },\n    getDetailPreliquidationsRequest: (state, action) => {},\n    getDetailPreliquidationsError: () => {},\n    getDetailPreliquidationsSuccess: (state, action) => {\n      state.detailPreliquidations = action.payload;\n    },\n    setDirty: (state, action) => {\n      state.dirty = action.payload;\n    },\n    setInvoiceFileStatus: (state, action) => {\n      state.invoiceFileStatus = { ...state.invoiceFileStatus,\n        ...action.payload\n      };\n    },\n    setActualPage: (state, action) => {\n      state.actualPage = action.payload;\n    },\n    resetAllSelected: (state, action) => {\n      state.preliquidationsSelected = [];\n    },\n    resetInvoiceDetail: state => {\n      state.invoiceDetail = initialState.invoiceDetail;\n    },\n    toggleItem: (state, action) => {\n      const item = action.payload;\n      const idx = state.preliquidationsSelected.findIndex(p => p.id === item.id);\n      if (idx >= 0) state.preliquidationsSelected.splice(idx, 1);else state.preliquidationsSelected.push(item);\n    },\n    toggleAll: state => {\n      const approvedItems = state.preliquidations.filter(p => p.status.tag === \"approved\"); // Estan todas las preli seleccionadas\n\n      if (approvedItems.length === state.preliquidationsSelected.length) state.preliquidationsSelected = [];else state.preliquidationsSelected = approvedItems;\n    }\n  },\n  extraReducers: builder => builder.addMatcher(isRequestAction, state => {\n    state.fetching = true;\n  }).addMatcher(isResponseAction, state => {\n    state.fetching = false;\n  })\n});\nexport const preliquidationSelector = state => state.preliquidations;\nexport const actions = preliquidationSlice.actions;\nexport const allPreliquidationsSelected = createSelector(state => state.preliquidations, preli => preli.preliquidationsSelected.length > 0 && preli.preliquidations.filter(p => p.status.tag === \"approved\").length === preli.preliquidationsSelected.length);\nexport const existApprovedPreliquidation = createSelector(state => state.preliquidations, preli => preli.preliquidations.some(p => p.status.tag === \"approved\"));\nexport default preliquidationSlice.reducer;","map":{"version":3,"sources":["/home/nahuel/pickers-admin-front/src/reducers/preliquidation.ts"],"names":["createSlice","createSelector","endsWithAny","initialState","fetching","invoiceFileStatus","error","loading","message","preliquidations","dirty","preliquidationsSelected","filters","filtersExtra","limit","offset","filtersExtraSeeMore","seeMore","invoiceTypes","detailPreliquidations","id","status","description","tag","generatedAt","fiscalNumber","companyName","sapCode","total","manualCorrection","maxAllowedPlus","maxAllowedSubtract","histories","transactions","quantity","items","invoiceDetail","emisionDate","invoiceNumber","salePoint","invoiceType","name","caeNumber","fiscalData","taxPayerType","invoiceFile","upload","url","presettementId","undefined","actualPage","SLICE_NAME","isRequestAction","action","type","startsWith","endsWith","isResponseAction","preliquidationSlice","reducers","reset","state","getPreliquidationsRequest","getMorePreliquidationsRequest","getPreliquidationsSuccess","payload","result","hasMore","getMorePreliquidationsSuccess","getPreliquidationsError","getMorePreliquidationsError","setPreliquidationFilters","setPreliquidationExtraFilters","getInvoiceDetailRequest","getInvoiceDetailError","getInvoiceDetailSuccess","presettlement","invoice","getInvoiceDetailSaveRequest","getInvoiceDetailSaveError","getInvoiceDetailSaveSuccess","getInvoiceDetailApproveRequest","getInvoiceDetailApproveError","getInvoiceDetailApproveSuccess","getInvoiceDetailDeleteRequest","getInvoiceDetailDeleteError","getInvoiceDetailDeleteSuccess","replaceInvoiceFile","replaceInvoiceFileError","uploadInvoiceFile","uploadInvoiceFileError","uploadInvoiceFileSuccess","deleteInvoiceFileRequest","deleteInvoiceFileError","deleteInvoiceFileSuccess","getInvoiceDetailTypesRequest","getInvoiceDetailTypesError","getInvoiceDetailTypesSuccess","getDetailPreliquidationsRequest","getDetailPreliquidationsError","getDetailPreliquidationsSuccess","setDirty","setInvoiceFileStatus","setActualPage","resetAllSelected","resetInvoiceDetail","toggleItem","item","idx","findIndex","p","splice","push","toggleAll","approvedItems","filter","length","extraReducers","builder","addMatcher","preliquidationSelector","actions","allPreliquidationsSelected","preli","existApprovedPreliquidation","some","reducer"],"mappings":"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","sourcesContent":["import {\n  Action,\n  createSlice,\n  PayloadAction,\n  createSelector,\n} from \"@reduxjs/toolkit\";\nimport { detailPreliquidationDatePicker } from \"pages/preliquidation/DetailPreliquidation/invoice/types\";\nimport { PagesPreliquidationTypes } from \"pages/preliquidation/DetailPreliquidation/types\";\nimport { PreliquidationFilterExtraType, PreliquidationFiltersType } from \"pages/preliquidation/filter/types\";\nimport {\n  DetailPreliquidationsContentResponseType,\n  InvoiceTypes,\n  PreliquidationItem,\n  PreliquidationParamsMiddlewareType,\n  PreliquidationsContentResponseType,\n  RejectInvoiceMiddlewareType,\n} from \"sagas/types/preliquidation\";\nimport { RootState } from \"store\";\nimport { endsWithAny } from \"utils/endsWithAny\";\nimport {\n  InvoiceFileStatus,\n  PreliquidationsSuccessMoreResponseType,\n  PreliquitadionStateType,\n} from \"./types/preliquidation\";\n\nexport const initialState: PreliquitadionStateType = {\n  fetching: false,\n  invoiceFileStatus: {\n    error: false,\n    loading: false,\n    message: \"\",\n  },\n  preliquidations: [],\n  dirty: false,\n  preliquidationsSelected: [],\n  filters: {},\n  filtersExtra: {\n    limit: 3,\n    offset: 0\n  },\n  filtersExtraSeeMore: {\n    limit: 15,\n    offset: 0\n  },\n  seeMore: true,\n\n\n  invoiceTypes: [],\n  detailPreliquidations: {\n    id: 0,\n    status: {\n        id: 0,\n        description: \"\",\n        tag: \"\",\n    },\n    generatedAt: \"\",\n    fiscalNumber: \"\",\n    companyName: \"\",\n    sapCode: \"\",\n    total: 0.0,\n    manualCorrection: {\n        maxAllowedPlus: 0.0,\n        maxAllowedSubtract: 0.0,\n    },\n    histories: [\n        \n    ],\n    transactions: {\n        quantity: 0,\n        items: []\n    }\n},\n  invoiceDetail: {\n    id: 0,\n    emisionDate: \"\",\n    invoiceNumber: \"\",\n    salePoint: \"\",\n    invoiceType: {\n      name: \"\",\n      tag: \"\",\n    },\n    caeNumber: \"\",\n    fiscalData: {\n      fiscalNumber: \"\",\n      companyName: \"\",\n      taxPayerType: \"\",\n      total: 0,\n    },\n    invoiceFile: {\n      upload: false,\n      url: null,\n    },\n    presettementId: undefined\n  },\n  actualPage:\"preliquidation\"\n};\n\nconst SLICE_NAME = \"preliquidation\";\n\nconst isRequestAction = (action: Action<string>) => {\n  const { type } = action;\n  return type.startsWith(SLICE_NAME) && type.endsWith(\"Request\");\n};\n\nconst isResponseAction = (action: Action<string>) => {\n  const { type } = action;\n  return type.startsWith(SLICE_NAME) && endsWithAny(type, [\"Error\", \"Success\"]);\n};\n\nexport const preliquidationSlice = createSlice({\n  name: SLICE_NAME,\n  initialState,\n  reducers: {\n    reset: (state: PreliquitadionStateType) => {\n      state = {\n        ...initialState,\n      };\n    },\n    getPreliquidationsRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationParamsMiddlewareType>\n    ) => {\n\n    },\n    getMorePreliquidationsRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationParamsMiddlewareType>\n    ) => {},\n    getPreliquidationsSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationsContentResponseType>\n    ) => {\n      const { payload } = action;\n      \n      state.preliquidations = payload.result.items;\n      state.seeMore = payload.hasMore;\n      state.filtersExtraSeeMore.offset = payload.offset + payload.limit;\n    },\n    getMorePreliquidationsSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationsSuccessMoreResponseType>\n    ) => {\n      const { payload } = action;\n      state.preliquidations = [...state.preliquidations, ...payload.items];\n      state.seeMore = payload.hasMore;\n      state.filtersExtraSeeMore.offset = payload.offset + payload.limit;\n\n    },\n    getPreliquidationsError: () => {},\n    getMorePreliquidationsError: () => {},\n    setPreliquidationFilters: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationFiltersType>\n    ) => {\n      state.filters = action.payload;\n    },\n    setPreliquidationExtraFilters: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationFilterExtraType>\n    ) => {\n\n      state.filtersExtra = { ...state.filtersExtra, ...action.payload };\n    },\n\n    getInvoiceDetailRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<string | undefined>\n    ) => {},\n    getInvoiceDetailError: () => {},\n    getInvoiceDetailSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<DetailPreliquidationsContentResponseType>\n    ) => {\n      const { payload } = action;\n      const { presettlement, ...invoice } = payload;\n      state.invoiceDetail = invoice;\n      state.detailPreliquidations = {\n        ...state.detailPreliquidations,\n        ...presettlement,\n      };\n    },\n    getInvoiceDetailSaveRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<detailPreliquidationDatePicker>\n    ) => {},\n    getInvoiceDetailSaveError: () => {},\n    getInvoiceDetailSaveSuccess: () => {},\n    getInvoiceDetailApproveRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<detailPreliquidationDatePicker>\n    ) => {},\n    getInvoiceDetailApproveError: () => {},\n    getInvoiceDetailApproveSuccess: () => {},\n    getInvoiceDetailDeleteRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<RejectInvoiceMiddlewareType>\n    ) => {},\n    getInvoiceDetailDeleteError: () => {},\n    getInvoiceDetailDeleteSuccess: () => {},\n    replaceInvoiceFile: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<{ id: number; content: string }>\n    ) => {},\n    replaceInvoiceFileError: (state: PreliquitadionStateType) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\",\n      };\n    },\n    uploadInvoiceFile: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<{ id: number; content: string }>\n    ) => {},\n    uploadInvoiceFileError: (state: PreliquitadionStateType) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\",\n      };\n    },\n    uploadInvoiceFileSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<string>\n    ) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: false,\n        message: \"\",\n      };\n      state.invoiceDetail.invoiceFile = {\n        upload: true,\n        url: action.payload,\n      };\n    },\n    deleteInvoiceFileRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<{ id: number }>\n    ) => {},\n    deleteInvoiceFileError: (state: PreliquitadionStateType) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: true,\n        message: \"component:label.pdfController.serverError\",\n      };\n    },\n    deleteInvoiceFileSuccess: (state: PreliquitadionStateType) => {\n      state.invoiceFileStatus = {\n        loading: false,\n        error: false,\n        message: \"\",\n      };\n      state.invoiceDetail.invoiceFile = {\n        upload: false,\n        url: null,\n      };\n    },\n\n    getInvoiceDetailTypesRequest: () => {},\n    getInvoiceDetailTypesError: () => {},\n    getInvoiceDetailTypesSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<InvoiceTypes[]>\n    ) => {\n      const { payload } = action;\n      state.invoiceTypes = payload;\n    },\n    getDetailPreliquidationsRequest: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<number>\n    ) => {},\n    getDetailPreliquidationsError: () => {},\n    getDetailPreliquidationsSuccess: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<any>\n    ) => {\n      state.detailPreliquidations = action.payload;\n    },\n    setDirty: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<boolean>\n    ) => {\n      state.dirty = action.payload;\n    },\n    setInvoiceFileStatus: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<InvoiceFileStatus>\n    ) => {\n      state.invoiceFileStatus = {\n        ...state.invoiceFileStatus,\n        ...action.payload,\n      };\n    },\n    setActualPage: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PagesPreliquidationTypes>\n    ) => {\n      state.actualPage = action.payload;\n    },\n    resetAllSelected: (\n      state: PreliquitadionStateType,\n      action: PayloadAction\n    ) => {\n      state.preliquidationsSelected = [];\n    },\n    resetInvoiceDetail: (state: PreliquitadionStateType) => {\n      state.invoiceDetail = initialState.invoiceDetail;\n    },\n    toggleItem: (\n      state: PreliquitadionStateType,\n      action: PayloadAction<PreliquidationItem>\n    ) => {\n      const item = action.payload;\n      const idx = state.preliquidationsSelected.findIndex(\n        (p) => p.id === item.id\n      );\n\n      if (idx >= 0) state.preliquidationsSelected.splice(idx, 1);\n      else state.preliquidationsSelected.push(item);\n    },\n    toggleAll: (state: PreliquitadionStateType) => {\n      const approvedItems = state.preliquidations.filter(\n        (p) => p.status.tag === \"approved\"\n      );\n      // Estan todas las preli seleccionadas\n      if (approvedItems.length === state.preliquidationsSelected.length)\n        state.preliquidationsSelected = [];\n      else state.preliquidationsSelected = approvedItems;\n    },\n  },\n  extraReducers: (builder) =>\n    builder\n      .addMatcher(isRequestAction, (state: PreliquitadionStateType) => {\n        state.fetching = true;\n      })\n      .addMatcher(isResponseAction, (state: PreliquitadionStateType) => {\n        state.fetching = false;\n      }),\n});\n\nexport const preliquidationSelector = (state: RootState) =>\n  state.preliquidations;\n\nexport const actions = preliquidationSlice.actions;\n\nexport const allPreliquidationsSelected = createSelector(\n  (state: RootState) => state.preliquidations,\n  (preli) => \n    preli.preliquidationsSelected.length > 0 &&\n    preli.preliquidations.filter((p) => p.status.tag === \"approved\").length ===\n      preli.preliquidationsSelected.length\n);\nexport const existApprovedPreliquidation = createSelector(\n  (state: RootState) => state.preliquidations,\n  (preli) =>preli.preliquidations.some((p) => p.status.tag === \"approved\")\n);\n\n\nexport default preliquidationSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}